<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Tasks</title>
    <link th:href="@{/styles/projectPage.css}" rel="stylesheet">
</head>
<body>

<div class="header">
    <img class="logo" src="/styles/logo.PNG">
    <div>
        <a class="header_button" href="/projects">Projects</a>
        <a class="header_button" href="/backToSubProject">SubProjects</a>
    </div>
    <div>
        <a class="header_button" href="/createTask">Create Task</a>
    </div>

</div>

<div class="project_body">
    <h2 class="header_project_title">All Tasks</h2>
    <div class="project_container">
        <div class="project_card_container" th:each="task : ${tasks}">
            <a class="project_card_link" th:href="@{/subTask(id=${task.getTaskId()})}">
                <div class="project_card">
                    <p class="title" th:text="${task.getTaskName}"><br></p>
                   <p class="description" th:text="${task.getTaskDescription()}" th:unless="${task.getTaskDependencies().size > 0}"></p>
                    <p class="title_dependencies" th:text="Dependencies" th:unless="${task.getTaskDependencies().size == 0}"></p>
                    <div class="dependencies_container">
                        <div class="description_dependencies_container" th:each="dependentTasksNames : ${task.getTaskDependencies()}" >
                            <span class="description_dependencies" th:text="${dependentTasksNames.getTaskName()}"></span>
                        </div>
                    </div>
                    <div class="project_time_remaining">
                        <span th:text="${task.getEstimatetWorkHours()}">Total required time</span>
                    </div>
                </div>

            </a>
            <div class="button_margin">
                <a class="project_changebtn" th:href="@{/updateTask(id=${task.getTaskId()})}">CHANGE</a>
                <!--  <a class="project_changebtn" th:href="@{/taskDependencies(id=${task.getTaskId()})}" th:unless="${task.getTaskDependencies().size == 0}">SE DEP</a> -->
            </div>
            <div style="margin-top: 20px;">
                <form name="dependency" action="/createTaskDependency/submit" method="post">
                    <label for="dependencies">Select Task to depend on: </label>
                    <select  id="dependencies">
                        <option value="">Select Task</option>

                        <div th:each="actualDependency : ${task.getTaskDependencies()}">
                        <option th:each="possibleDependancy : ${tasks}"   th:value="${possibleDependancy.getTaskName()}" th:text="${possibleDependancy.getTaskName()}"
                                th:if="${possibleDependancy.getTaskId() != actualDependency.getTaskId() and possibleDependancy.getTaskId() != task.getTaskId()}"></option>
                        </div>

                    </select>
                    <button type="submit">Submit</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!--
<th:block>
<table>
    <tr class="trHeader">
    <th>Opgavenavn</th>
    <th>Opgaven er afhængig af</th>
    </tr>

    <th:block th:each="tasks : ${tasks}">
    <tr class="tr" >

        <td><a class="td" th:href="@{/subTask(id=${tasks.getTaskId()})}" th:text="${tasks.getTaskName()}"></a>
        </td>
        <td class="dependencies" th:each="dependentTasksNames : ${tasks.getTaskDependencies()}" th:text="${dependentTasksNames}"></td>
          <td th:text="${tasks.getTaskDescription()}"></td>
    </tr>
    </th:block>



</table>
-->
    <!--
</table>
</th:block>

<table th:each="tasks : ${tasks}">
    <tbody class="tbody">
    <tr class="tr">
        <th class="th" th:href="@{/subTask(id=${tasks.getTaskId()})}" th:text="${tasks.getTaskName()} + ' afhængig af: '"><br>> NAME & AGE </th>
        <td class="td" th:each="dependentTasksNames : ${tasks.getTaskDependencies()}" th:text="${dependentTasksNames}"></td>

    </tr>
    </tbody>
</table>

    -->




<!--
<div th:each="tasks : ${tasks}">
    <div style="background: aqua; width: 75px">
        <a th:href="@{/subTask(id=${tasks.getTaskId()})}">
            <p th:text="${tasks.getTaskName()}"><br></p>
            <p th:text="${tasks.getTaskDescription()}"></p>
        </a>
        <a th:href="@{/updateTask(id=${tasks.getTaskId()})}">ÆNDRE</a>
    </div>
    <br>
</div>
-->


</body>
</html>